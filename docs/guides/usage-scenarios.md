# 使用场景

本文档介绍桌面端与 Web/Gateway 下的典型使用场景，按步骤指导你完成常见任务。本系统中「智能体」「助手」「专家」均指同一概念，可互换使用。

---

## 场景一：在对话框中整理本机下载目录

**目标**：不离开对话界面，让智能体帮你整理当前用户下的「下载」目录（分类、重命名或清理）。

**适用**：桌面端、Web 端（连接同一 Gateway 时）。

### 步骤

1. **选择智能体**  
   在输入框上方或会话入口选择 **「本地文件助手」**（或具备文件操作技能的智能体）。若未看到该智能体，可在 **设置 → 智能体** 中确认预装的「本地文件助手」已存在并启用。

2. **发起对话**  
   新建会话或进入已有会话，在输入框中输入自然语言需求，例如：
   - 「帮我整理一下当前用户下的下载目录，按文件类型分到子文件夹」
   - 「把下载目录里超过 30 天的安装包移到“旧文件”文件夹」
   - 「列出下载目录里最大的 10 个文件，并问我是否要删除」

3. **确认与执行**  
   智能体会根据技能（如文件搜索、整理）理解你的意图，必要时列出计划或路径并**征求你确认**后再执行删除、移动等操作，避免误删。

4. **查看结果**  
   对话中会返回执行结果（成功/失败、移动了哪些文件等）。若需查看实际目录，可到本机「下载」文件夹核对，或在对话中继续追问「下载目录里现在有哪些子文件夹」。

**提示**：涉及删除、移动时，智能体一般会先说明将要执行的操作，请确认后再继续；若未配置「本地文件助手」，可选用**主智能体**并说明「用文件操作能力整理下载目录」，主智能体若已加载文件相关技能也可完成。

---

## 场景二：自动创建并切换到新的专家/助手

**目标**：在对话中让当前智能体「创建一个新的专家/助手」，并自动切换到该智能体，后续对话由新智能体处理。

**适用**：桌面端、Web 端（Gateway 需支持 `create_agent`、`switch_agent` 工具）。

### 步骤

1. **发起创建请求**  
   在当前会话中输入自然语言，例如：
   - 「帮我创建一个美妆助手，专门回答护肤和化妆问题」
   - 「创建一个代码审查专家，工作空间叫 code-review」
   - 「新建一个叫“周报助手”的智能体，用来写周报」

2. **智能体调用创建工具**  
   当前智能体会调用 **create_agent** 工具，根据你的描述生成：
   - **名称**（如「美妆助手」）
   - **工作空间**（英文标识，未指定时根据名称自动生成）
   - **系统提示词**（未指定时根据名称生成简短角色描述）

3. **确认创建结果**  
   对话中会返回类似：「已创建智能体「美妆助手」（ID: xxx）。用户可通过 list_agents 查看、并调用 switch_agent 切换到该智能体使用。」

4. **切换到新智能体**  
   在同一会话中继续输入，例如：
   - 「切换到美妆助手」
   - 「用刚才创建的那个智能体」  
   智能体会调用 **switch_agent**，将当前会话绑定的智能体改为新建的 ID；**之后你发送的消息都会由新智能体处理**。

5. **验证**  
   切换后直接提问与新角色相关的问题（如「推荐一款适合干皮的面霜」），应是由新智能体（美妆助手）回答。

**提示**：新建智能体使用全局默认模型与配置；若需改模型或执行方式，可到 **设置 → 智能体** 中找到该智能体（按名称或工作空间）进行编辑。`list_agents` 可列出所有智能体 ID，便于你指定要切换的对象。

---

## 场景三：在某个智能体中自动新增自己的技能

**目标**：在对话中让智能体「给当前助手安装某个技能」，技能安装到**当前会话所用智能体**对应的工作区，仅该智能体可用。

**适用**：桌面端、Web 端；当前会话使用的智能体为本机执行（local）时。

### 步骤

1. **选择目标智能体**  
   在输入框上方选择要在其下安装技能的智能体（如「编码助手」「文档助手」或你自定义的某个助手），并确保该智能体为**本机执行**（非 Coze/OpenClawX 代理）。

2. **在对话中请求安装**  
   在该智能体的会话中输入，例如：
   - 「给当前助手安装一个能处理 PDF 的技能，从 xxx/xxx 仓库安装」
   - 「安装技能：owner/repo」（GitHub 简写）
   - 「从 https://github.com/xxx/yyy 安装技能 yyy」

3. **智能体调用安装工具**  
   智能体会调用 **install_skill** 工具，传入技能地址（GitHub 简写、完整 URL 或 `owner/repo@skillName`）。安装目标为**当前会话的智能体工作区**（`~/.openbot/workspace/<workspace>/skills/`）。

4. **确认安装结果**  
   对话中会返回安装结果（成功/失败、安装目录等）。若成功，**新技能会在该智能体下次会话或新会话中自动加载**，无需重启应用。

5. **验证**  
   在同一智能体下继续对话，用自然语言触发新技能（如「用刚才装的 PDF 技能把这份文档转成摘要」），或到 **技能** 页面查看该工作区下是否多出对应技能。

**提示**：技能安装到「当前智能体」对应工作区，其他智能体不会自动拥有该技能；若需多个智能体共用，可后续在设置/工作区中手动拷贝，或使用全局技能目录（见 [技能系统](../features/skills.md)）。

---

## 场景四：通过对智能体智能化新增技能（发现 + 安装）

**目标**：不确定技能叫什么、在哪找时，用自然语言描述需求，让智能体先**发现**再**安装**合适技能，实现「智能化新增技能」。

**适用**：桌面端、Web 端；当前智能体已加载 **find-skills** 且为本机执行。

### 步骤

1. **选择智能体**  
   选择要为其增加能力的智能体（如主智能体或「文档助手」），并确保其为本机执行。

2. **用需求描述请求**  
   在对话中输入模糊或具体需求，例如：
   - 「帮我找并安装一个能处理 Excel 的技能」
   - 「有没有可以生成图表的技能？有的话给当前助手装上」
   - 「用 find-skills 搜一下 PDF 相关技能，选一个安装到当前助手」

3. **发现与选择**  
   智能体会先调用 **find-skills**（或内置技能发现能力）搜索技能目录，在回复中列出候选（名称、描述、来源）。你可在对话中指定「安装第一个」或「安装 xxx 那个」。

4. **安装**  
   智能体再调用 **install_skill**，将选中的技能安装到当前智能体工作区，并返回安装结果。

5. **验证**  
   在同一智能体下提问与新技能相关的问题，或到 **技能** 页面确认新技能已出现在该智能体对应工作区下。

**提示**：若当前智能体没有 find-skills，可先用**主智能体**执行「发现并安装某类技能」，再通过 **switch_agent** 切到目标智能体；若希望目标智能体自己也具备发现能力，可先给该智能体安装 find-skills（若支持）或使用主智能体代为安装到其工作区（需按实际支持的安装目标操作）。

---

## 场景五：手工为某个智能体新增 MCP 能力

**目标**：为指定智能体配置 MCP（Model Context Protocol）服务器，使该智能体在对话中能调用外部工具（如数据库、API、RPA）。

**适用**：桌面端；不依赖对话，纯配置操作。

### 步骤

1. **打开智能体配置**  
   进入 **设置 → 智能体**，在列表中找到要配置的智能体，点击进入其**详情/编辑**页。

2. **打开 MCP 配置**  
   在智能体详情中切换到 **「MCP 配置」** Tab（或「MCP 服务器」等等价入口）。

3. **新增 MCP 服务器**  
   - **方式 A（表单）**：点击「添加」或「新增」，填写：
     - **名称**：便于识别的名称（如「影刀 RPA」「文颜 MCP」）。
     - **连接方式**：通常为 **stdio**（本地进程）或 **SSE**（远程）。
     - **stdio**：填写 **命令**（如 `npx`）、**参数**（如 `["-y", "yingdao-mcp-server"]`）、可选**环境变量**。
     - **SSE**：填写 **URL**、可选 **headers**（如 API Key）。
   - **方式 B（JSON）**：若界面支持「整段 JSON 编辑」，可粘贴标准 `mcpServers` 对象，例如：
     ```json
     {
       "YingDao RPA MCP Server": {
         "command": "npx",
         "args": ["-y", "yingdao-mcp-server"],
         "env": {}
       }
     }
     ```

4. **保存并生效**  
   保存智能体配置。**配置更新即生效**：下次使用该智能体创建新会话或发送新消息时，Gateway 会按新配置启动 MCP 服务器，会话内即可调用对应工具。

5. **验证**  
   选择该智能体并新建会话，用自然语言触发 MCP 提供的功能（如「用影刀执行某某流程」），若配置正确，智能体会调用 MCP 暴露的工具并返回结果。

**提示**：MCP 服务器通常需本机已安装对应 CLI 或依赖（如 `npx -y yingdao-mcp-server` 需网络可访问 npm）；环境变量（如 API Key、路径）在 **env** 中配置，避免写进命令行参数。详见 [智能体配置](../configuration/agents.md) 与发布说明中的 MCP 章节。

---

## 场景六：绑定某个智能体做定时任务

**目标**：创建一个定时任务（如每天 9 点执行），让**指定智能体**在指定时间自动收到一条消息并执行，结果记录在任务执行历史中。

**适用**：桌面端、Web 端（通过 API）；需 Gateway 与任务调度正常运行。

### 步骤

1. **打开任务列表**  
   在桌面端侧栏或主导航进入 **「任务（Tasks）」**。

2. **新建任务**  
   点击「新建任务」或「添加定时任务」。

3. **选择工作区（即绑定智能体）**  
   任务按**工作区（workspace）**执行：选择要执行该任务的**智能体对应工作区**。  
   - 若智能体 ID 与工作区一致（如 `file-assistant` 对应工作区 `file-assistant`），则选择该工作区即表示「用该智能体执行」。  
   - 主智能体对应工作区一般为 `default`。  
   界面可能显示为「选择智能体」或「工作区」，选择你希望执行定时任务的智能体即可。

4. **填写执行内容与 schedule**  
   - **消息（message）**：到点时发给智能体的提示词，例如「整理一下今天要处理的待办并列出前 5 条」「总结昨天保存的 experience 中与项目 A 相关的要点」。  
   - **执行方式**：  
     - **单次（once）**：指定具体时间点执行一次。  
     - **重复（cron）**：按日/工作日/周末/周几/每月某日等规则重复，填写时间（如 09:00）与规则类型。

5. **保存并启用**  
   保存任务并确保任务为**启用**状态。Gateway 会按 cron 或单次时间触发执行：使用该工作区对应智能体、创建或复用系统会话、发送你填写的消息、将助手回复与执行状态写入**任务执行历史**。

6. **查看结果**  
   在 **任务 → 某任务 → 执行历史** 中查看每次执行的时间、状态（成功/失败）、助手回复摘要或错误信息。

**提示**：定时任务复用同一会话 ID 时，若上一次执行尚未结束，本次会等待或报「Agent is already processing」；可适当错开高耗时任务的执行时间。任务执行会消耗模型 Token，可在使用统计或任务详情中查看。

---

## 场景八：对接 OpenCode 并用斜杠指令开发

**目标**：将智能体代理至 [OpenCode](https://opencode.ai/) 官方 Server，在桌面/Web 对话中使用 OpenCode 的编码能力与斜杠指令（如 `/init`、`/undo`、`/share`），实现「本机 0 Token」的代码分析与协作。**适用**：桌面端、Web 端；本机或远程 OpenCode Server。

**对接方式与细节**：(1) 本地模式安装 OpenCode（如 `curl -fsSL https://opencode.ai/install | bash` 或 `npm install -g opencode-ai`），运行 `opencode serve`（默认端口 4096）；远程模式使用已部署 Server。 (2) **设置 → 智能体** → 执行方式选 **OpenCode**，填端口或地址；详见 [智能体配置](../configuration/agents.md)、[代理模式与多节点协作](../features/proxy-mode.md)。 (3) 对话中支持 `/init`、`/undo`、`/redo`、`/share`、`/help`；详见 [opencode.ai/docs](https://opencode.ai/docs)、[分享](https://opencode.ai/docs/share)。

**官方与配置**：[opencode.ai](https://opencode.ai/) / [opencode.ai/docs](https://opencode.ai/docs)；OpenClawX **设置 → 智能体**。

---

## 场景九：通过 MCP 对接 RPA（影刀）在对话中执行自动化

**目标**：为智能体配置影刀 RPA 的 MCP 服务，在对话中调用影刀执行流程。**适用**：桌面端；本机可运行 `npx`。

**对接方式与细节**：(1) 使用 [yingdao-mcp-server](https://www.npmjs.com/package/yingdao-mcp-server)。 (2) **设置 → 智能体** → 该智能体 → **MCP 配置** → 添加：名称「影刀 RPA」，stdio，命令 `npx`，参数 `["-y", "yingdao-mcp-server"]`，可选 env（如 `RPA_MODEL`、`SHADOWBOT_PATH`）。 (3) 对话中用自然语言触发 RPA。详见 [智能体配置](../configuration/agents.md)。

**官方与配置**：[yingdao-mcp-server](https://www.npmjs.com/package/yingdao-mcp-server)；**设置 → 智能体** → MCP 配置。

---

## 场景十：对接 Coze 并使用国内/国际站 Bot

**目标**：将智能体代理至 Coze（国内/国际站），在桌面/Web/通道中使用 Coze Bot，本机 0 Token。**适用**：桌面端、Web 端、通道；需在 Coze 创建 Bot 并获取凭证。

**对接方式与细节**：(1) 国内站 [coze.cn](https://www.coze.cn)、国际站 [coze.com](https://www.coze.com) 获取 Bot ID 与 Access Token；两站凭证不通用。 (2) **设置 → 智能体** → 执行方式 **Coze**，区域选国内(cn)/国际(com)，填写对应 Bot ID 与 Token。 (3) 通道可在 **设置 → 通道配置** 指定该智能体为默认。详见 [智能体配置](../configuration/agents.md)、[代理模式与多节点协作](../features/proxy-mode.md)、[通道配置](../configuration/channels.md)。

**官方与配置**：Coze 国内 [www.coze.cn](https://www.coze.cn)、国际 [www.coze.com](https://www.coze.com)；OpenClawX **设置 → 智能体**。

---

## 场景与入口对照

| 场景             | 主要入口           | 依赖                     |
|------------------|--------------------|--------------------------|
| 整理下载目录     | 对话 + 本地文件助手 | 预装「本地文件助手」     |
| 创建并切换智能体 | 对话 + create_agent / switch_agent | Gateway 注入工具、桌面/Web 会话 |
| 为当前智能体安装技能 | 对话 + install_skill | 本机智能体、技能地址     |
| 智能化新增技能   | 对话 + find-skills + install_skill | find-skills、本机智能体  |
| 手工新增 MCP     | 设置 → 智能体 → MCP 配置 | 无                       |
| 绑定智能体定时任务 | 任务 → 新建 → 选工作区/智能体 | Gateway、任务调度        |
| 对接 OpenCode 并用斜杠指令开发 | 设置 → 智能体（OpenCode）+ 对话 /init、/share 等 | 本机或远程 OpenCode Server |
| 通过 MCP 对接 RPA（影刀） | 设置 → 智能体 → MCP 配置（yingdao-mcp-server） | Node/npx、影刀 MCP 包     |
| 对接 Coze 使用国内/国际站 Bot | 设置 → 智能体（Coze）+ 区域与 Bot ID/Token | Coze 平台 Bot 与凭证     |

---

## 下一步

- [桌面端使用](desktop-usage.md)：启动方式、智能体/技能/任务入口
- [Web 与 Gateway](gateway-web.md)：启动网关、连接方式
- [智能体配置](../configuration/agents.md)：执行方式（本机/Coze/OpenClawX/OpenCode）、MCP 与工作区
- [代理模式与多节点协作](../features/proxy-mode.md)：Coze、OpenCode 代理配置要点
- [通道配置](../configuration/channels.md)：飞书/钉钉/Telegram 默认智能体
- [技能系统](../features/skills.md)：技能规范、加载路径与安装

[← 返回文档首页](../README.md)
